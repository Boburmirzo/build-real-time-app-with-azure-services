"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const assert_1 = tslib_1.__importDefault(require("assert"));
const __1 = require("../..");
const TestHelpers_1 = require("../common/TestHelpers");
const endpoint = "https://localhost:443";
const masterKey = "C2y6yDjf5/R+ob0N8A7Cgv30VRDJIWEHLM+4QDU5DE2nQ9nDuVTqobD4b8mGGyPMbIZnqyMsEcaGQy67XIw/Jw==";
// TODO: Skipping these tests for now until we find a way to run these tests in a seperate nodejs process
// Currently all tests are run in same process so we cannot update the environment variables for different tests
// This test runs fine when run independently but fails when run along with rest of the tests.
describe.skip("Validate SSL verification check for emulator", function () {
    it("nativeApi Client Should throw exception", function () {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            try {
                const client = new __1.CosmosClient({ endpoint, auth: { masterKey } });
                // create database
                yield TestHelpers_1.getTestDatabase("ssl verification", client);
            }
            catch (err) {
                // connecting to emulator should throw SSL verification error,
                // unless you explicitly disable it via connectionPolicy.DisableSSLVerification
                assert_1.default.equal(err.code, "DEPTH_ZERO_SELF_SIGNED_CERT", "client should throw exception");
            }
        });
    });
    it("nativeApi Client Should successfully execute request", function () {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            const connectionPolicy = new __1.DocumentBase.ConnectionPolicy();
            // Disable SSL verification explicitly
            connectionPolicy.DisableSSLVerification = true;
            const client = new __1.CosmosClient({
                endpoint,
                auth: { masterKey },
                connectionPolicy
            });
            // create database
            yield TestHelpers_1.getTestDatabase("ssl verification", client);
        });
    });
});
//# sourceMappingURL=sslVerification.spec.js.map